<html>
    <head>
        <title>IMP projekt</title>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
        <style type='text/css'>
            .flex {
                display: flex;
                padding: 5px 10px;
            }
        </style>
    </head>
    <body>
        <div id='SecResultsId' style='height: 80%; border: solid #aaa 1px; overflow:auto;'>
            <div class='flex' style='border-bottom: solid 2px gray;'> 
                <div style='width: 50%;'>Čas měření</div> 
                <div style='width: 50%;'>Teplota</div> 
            </div>
        </div> 
        <form onsubmit='return false;' style='margin-top: 5px;'>
            <div class='flex'>
                <div style='width: 12%;'>
                    <div style='margin-top: 11px;'>
                        <label for='loginId'>Váš login:</label>
                    </div>
                    <div style='margin-top: 8px;'>
                        <label for='messageId'>Text zprávy:</label>
                    </div>
                </div>
                <div style='width: 70%;'>
                    <div style='margin-top: 5px;'>
                        <input type='text' id='loginId' placeholder='xlogin00' style='margin-top: 5px;'>
                    </div>
                    <div style='margin-top: 5px;'>
                        <textarea id='messageId' placeholder='Napište zprávu' style='min-width: 100%;'></textarea>
                    </div>
                </div>
            </div>
            <input type='button' value='Odeslat' onclick='UploadData()' style='margin-top: 10px; margin-left: 10px;'>
        </form>
  
        <script type='text/javascript'>            
            const READY_STATE_FINISHED = 4;
            const STATUS_OK = 200;

            function CreateMessageDiv(message)
            {
                const mainDiv = document.createElement('div');
                mainDiv.classList.add('flex');
                
                const timeDiv = document.createElement('div');
                timeDiv.style.width = '50%';
                timeDiv.innerText = message.a;
                
                const tempDiv = document.createElement('div');
                tempDiv.style.width = '50%';
                tempDiv.innerText = message.b;

                mainDiv.appendChild(timeDiv);
                mainDiv.appendChild(tempDiv);

                return mainDiv;
            }

            function AppendMessages(messages, messageList)
            {
                console.log(messages);
                for (let message of messages)
                {
                    if (document.getElementById(message.id) == null)
                    {
                        messageList.appendChild(CreateMessageDiv(message));
                    }
                }
            }
        
            function GetData()
            {
                let request = new XMLHttpRequest();
                request.open('GET', 'http://192.168.1.113/', true);
                request.onreadystatechange = function()
                {
                    if ((request.readyState == READY_STATE_FINISHED) && (request.status == STATUS_OK))
                    {
                        console.log(request.responseText);
                        return;
                        let secResults = document.getElementById('SecResultsId');
                        AppendMessages(JSON.parse(request.responseText), secResults);
                        secResults.scrollTop = 999999999;
                    }
                }
            
                request.send();
            }
        
            document.addEventListener('DOMContentLoaded', () => 
            {
                GetData();
                //setInterval(() => { console.log('getting data.'); GetData(); }, 3000);
            });
        </script>
    </body>
</html>